.rpl-timeline {
  --local-title-height: var(--rpl-type-lh-2);
  --local-img-height: 88px;
  --local-point-thickness: calc(var(--local-title-height) / 4);
  --local-clr-border: var(--rpl-clr-neutral-300);

  &__items {
    align-items: flex-start;
    display: flex;
    flex-direction: column;
    position: relative;
    padding: var(--rpl-sp-4) 0 0;
  }

  &__item {
    list-style-type: none;
    position: relative;
    padding-bottom: calc(var(--local-title-height) * 2);
    padding-left: calc(var(--local-point-thickness) * 6);
    border-left: var(--local-point-thickness) solid var(--local-clr-border);

    &::before {
      content: '';
      position: absolute;
      z-index: 1;
      height: var(--local-point-thickness);
      width: calc(var(--local-point-thickness) * 3); /* 12px */
      background-color: var(--local-clr-border);
      top: calc(var(--local-point-thickness) / 2);
      left: 0;
    }

    &:first-child,
    &:last-child {
      border-left-color: transparent;

      &::after {
        content: '';
        display: inline-block;
        position: absolute;
        z-index: 2;
        background-color: var(--local-clr-border);
        height: calc(100% + var(--local-point-thickness));
        width: var(--local-point-thickness);
        top: calc(var(--local-point-thickness) / 2);
        bottom: 0;
        left: calc(var(--local-point-thickness) * -1);
      }
    }

    &:first-child {
      &::before {
        left: calc(var(--local-point-thickness) * -1);
        width: calc(var(--local-point-thickness) * 4); /* 16px */
        z-index: 3;
      }
    }

    &:last-child {
      &::after {
        /* 6px */
        height: calc(var(--local-point-thickness) * 1.5);
        top: 0;
        z-index: 3;
      }
    }

    &-image {
      height: var(--local-img-height);
      width: var(--local-img-height);
      border-radius: 100%;
    }

    &-title {
      /* exactly half the title height */
      margin-top: -0.5em;
      margin-bottom: 0;
    }

    &-link {
      color: var(--rpl-clr-type-default);
    }

    &-subtitle,
    &-description > p {
      margin: 0 0 1rem;
    }

    &--with-image {
      .rpl-timeline__item-image {
        /* half img height, offset by 20px gap */
        margin-top: calc(var(--rpl-sp-5) - (var(--local-img-height) / 2));
      }

      &::before {
        top: calc(var(--local-title-height) + var(--local-point-thickness) / 2);
      }

      &:first-child::after {
        top: var(--rpl-sp-5);
      }

      .rpl-timeline__item-title {
        margin-top: 0;
      }

      &:last-child {
        margin-top: calc(
          var(--local-title-height) - var(--local-point-thickness)
        );

        &::after {
          /* half img height minus 1.5 borders */
          height: calc(
            var(--local-img-height) / 2 - var(--local-point-thickness) * 1.5
          );
          margin-top: calc(var(--local-title-height) * -1);
        }
      }
    }

    &--active {
      border-left-color: var(--rpl-clr-primary);

      &::after,
      &::before {
        background-color: var(--rpl-clr-primary);
      }

      &:first-child,
      &:last-child {
        &::after,
        &::before {
          background-color: var(--rpl-clr-primary);
        }
      }
    }

    &--current {
      .rpl-timeline__item-title {
        color: var(--rpl-clr-primary);
      }

      &::before,
      &:last-child::after {
        background-color: var(--rpl-clr-primary);
      }
    }
  }
}
